(function(a){a.fn.stonktable=function(b){return this.each(function(){var c=a(this);b=b||{};b=a.extend({},{"int":function(d,e){return parseInt(d,10)-parseInt(e,10)},"float":function(d,e){return parseFloat(d)-parseFloat(e)},string:function(d,e){return d<e?-1:d>e?1:0},"string-ins":function(d,e){d=d.toLowerCase();e=e.toLowerCase();return d<e?-1:d>e?1:0}},b);c.on("click","th",function(){var e=c.children("tbody").children("tr"),f=a(this),g=0,i=a.fn.stonktable.dir;c.find("th").slice(0,f.index()).each(function(){var j=a(this).attr("colspan")||1;g+=parseInt(j,10)});var d=f.data("sort-dir")===i.ASC?i.DESC:i.ASC,h=d==i.DESC?f.data("sort-desc")||f.data("sort")||null:f.data("sort")||null;null!==h&&(c.trigger("beforetablesort",{column:g,direction:d}),c.css("display"),setTimeout(function(){var j=[],o=b[h];e.each(function(p,l){var r=a(l).children().eq(g),q=r.data("sort-value"),r="undefined"!==typeof q?q:r.text();j.push(r)});var n=[],m=0;if(f.data("sort-dir")&&!f.data("sort-desc")){for(o=j.length-1;0<=o;o--){n.push(o)}}else{for(var k=j.slice(0).sort(o),o=0;o<j.length;o++){for(m=a.inArray(j[o],k);-1!=a.inArray(m,n);){m++}n.push(m)}}c.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc");f.data("sort-dir",d).addClass("sorting-"+d);m=e.slice(0);for(k=o=0;k<n.length;k++){o=n[k],m[o]=e[k]}n=a(m);c.children("tbody").append(n);c.trigger("aftertablesort",{column:g,direction:d});c.css("display")},10))})})};a.fn.stonktable.dir={ASC:"asc",DESC:"desc"}})(jQuery);